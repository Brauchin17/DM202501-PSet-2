{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-09-30T17:29:39.094300Z", "invocation_id": "67ba8ff8-c347-4073-9417-db560462775b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-30T17:29:08.398050Z", "completed_at": "2025-09-30T17:29:08.414906Z"}, {"name": "execute", "started_at": "2025-09-30T17:29:08.416462Z", "completed_at": "2025-09-30T17:29:38.847130Z"}], "thread_id": "Thread-29 (worker)", "execution_time": 30.692764282226562, "adapter_response": {"_message": "SUCCESS 1000", "code": "SUCCESS", "rows_affected": 1000, "query_id": "01bf66b9-0000-36a1-0055-1e0b000b0162"}, "message": null, "failures": null, "unique_id": "model.scheduler.dim_time", "compiled": true, "compiled_code": "\n  \n  \n\n\nwith raw_times as (\n    select \n        date_part(hour, pickup_datetime) as hour,\n        date_part(minute, pickup_datetime) as minute\n    from NY_TAXI.SILVER.STG_TRIPS\n    union all  -- UNION ALL + DISTINCT es m\u00e1s eficiente que UNION\n    select \n        date_part(hour, dropoff_datetime) as hour,\n        date_part(minute, dropoff_datetime) as minute\n    from NY_TAXI.SILVER.STG_TRIPS\n),\nunique_times as (\n    select distinct\n        hour,\n        minute\n    from raw_times\n)\nselect\n    (hour * 100 + minute) as time_sk,  -- Tu SK original en formato HHMM\n    to_time(\n        lpad(to_varchar(hour), 2, '0') || ':' || \n        lpad(to_varchar(minute), 2, '0') || ':00'\n    ) as full_time,  -- Columna TIME para joins\n    hour,  -- 0-23\n    minute,  -- 0-59\n    0 as second,  -- Fijo, ya que no extraes segundos\n    hour * 60 + minute as minute_of_day,  -- Minutos transcurridos en el d\u00eda (0-1439)\n    floor(minute / 15) + 1 as quarter_hour,  -- Cuarto de hora (1: 0-14, 2: 15-29, 3: 30-44, 4: 45-59)\n    floor(minute / 30) + 1 as half_hour,  -- Media hora (1: 0-29, 2: 30-59)\n    case \n        when hour < 12 then 'AM' \n        else 'PM' \n    end as am_pm,  -- AM/PM\n    case \n        when mod(hour, 12) = 0 then 12 \n        else mod(hour, 12) \n    end as hour_12_format,  -- Hora en formato 12h\n    case \n        when hour between 6 and 18 then 'day'\n        else 'night'\n    end as day_period, \nfrom unique_times\norder by hour, minute\n  \n  limit 1000\n", "relation_name": "NY_TAXI.GOLD.dim_time"}], "elapsed_time": 33.52948212623596, "args": {"favor_state": false, "show_resource_report": false, "version_check": true, "enable_legacy_logger": false, "which": "show", "populate_cache": true, "output": "text", "project_dir": "/home/src/scheduler/dbt/scheduler", "print": true, "profiles_dir": "/home/src/scheduler/.profiles_interpolated_temp_e047c2be-a6df-4107-b9f9-07dd3ce52966", "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "write_json": true, "macro_debugging": false, "strict_mode": false, "log_format": "default", "quiet": false, "use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "introspect": true, "require_resource_names_without_spaces": false, "invocation_command": "dbt -f /tmp/tmpn6b46gn1.json", "log_level": "info", "log_format_file": "debug", "partial_parse": true, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "defer": false, "static_parser": true, "limit": 1000, "log_level_file": "debug", "exclude": [], "vars": {"env": "dev", "execution_date": "2025-09-30T17:28:24.680488", "interval_end_datetime": "2025-10-01T17:28:24.680488", "interval_start_datetime": "2025-09-30T17:28:24.680488", "event": {}, "configuration": {"dbt_project_name": "dbt/scheduler", "file_path": "dbt/scheduler/models/clean/dim_time.sql", "file_source": {"path": "dbt/scheduler/models/clean/dim_time.sql", "project_path": "dbt/scheduler"}, "limit": 1000}, "context": {}, "pipeline_uuid": "taxi_trips_clustering", "block_uuid": "dbt/scheduler/models/clean/dim_time", "repo_path": "/home/src/scheduler"}, "log_path": "/home/src/scheduler/dbt/scheduler/logs", "select": ["dim_time"], "source_freshness_run_project_hooks": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "cache_selected_only": false, "partial_parse_file_diff": true}}